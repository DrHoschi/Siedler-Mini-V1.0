<!doctype html>
<html lang="de">
<head>
  <!-- =========================================================
       META / BASIS
       ========================================================= -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <meta name="theme-color" content="#1f1f23">
  <title>Neue Siedler</title>

  <!-- =========================================================
       STYLES (Global → Start → Inspector → Layout)
       - ?v=… als einfaches Cache-Busting: Zahl erhöhen bei Updates
       - WICHTIG: ui-layout.css greift NUR mit body.is-playing (Start-BG bleibt sichtbar)
       ========================================================= -->
  <link rel="stylesheet" href="ui/css/ui.css?v=25.10.19-final2">
  <link rel="stylesheet" href="ui/css/ui-start.css?v=25.10.19-final2">
  <link rel="stylesheet" href="ui/css/ui-inspector.css?v=25.10.19">
  <link rel="stylesheet" href="ui/css/ui-layout.css?v=25.10.19-final2"><!-- greift erst mit .is-playing -->
</head>

<body>
  <!-- =========================================================
       WICHTIG: Diese Container erwartet dein Code (Lastenheft 3.1 / 4.2–4.3)
       ========================================================= -->
  <canvas id="game-canvas" aria-label="Spielfeld"></canvas>
  <div id="ui-root" aria-live="polite"></div>

  <!-- HUD + BuildDock Platzhalter -->
<div id="hud-root" aria-live="polite"></div>
<div id="build-dock" hidden></div>
<button id="btn-build" aria-label="Bau-Menü" hidden></button>

<!-- Inspector-FAB (Pflicht laut Vorgaben) -->
<!-- <button id="btn-inspector" aria-label="Inspector" title="Inspector (I)" hidden></button> -->
 <!-- <button id="btn-inspector" aria-label="Inspector" title="Inspector (I)"></button> -->
  <!-- =========================================================
       SCRIPTS – LADEREIHENFOLGE (kritisch!)
       ========================================================= -->

  <!-- 1) Logging/Polyfills (falls vorhanden) -->
  <script src="core/cblog.polyfill.js?v=25.10.19-final2"></script>

  <!-- 2) Optionaler Mini-EventBus (falls vorhanden) -->
  <script src="core/eventbus.js?v=25.10.19-final2"></script>

  <!-- 3) INSPECTOR – sehr früh laden: hookt console/CBLog direkt nach Start
         Overlay bleibt standardmäßig geschlossen.
         <!-- Monolith-Inspector: Core + Modules -->
<!-- Dein modularer Inspector -->
<script defer src="ui/inspector/inspector.core.js?v=18.16.3"></script>
<script defer src="ui/ui-inspector.js?v=18.14.7"></script>
  
<script defer src="ui/inspector/inspector.button-bind.js"></script>
  
  
<!-- APIs & Kompat -->
<!--script defer src="ui/inspector/inspector.api-compat.restore.js"></script
<script defer src="ui/inspector/inspector.api-bridge.js"></script>
<script defer src="ui/inspector/inspector.api-compat.js"></script>

  <script defer src="ui/inspector/inspector.force-toggle.js"></script>
<script defer src="ui/inspector/inspector.compat.js"></script> -->

<!-- UI-Bindings -->




<!-- Taps  Feature-Module -->
<script defer src="ui/inspector/inspector.ui.js?v=18.17.0"></script>
<script defer src="ui/inspector/inspector.logs.js?v=18.14.5"></script>
<script defer src="ui/inspector/inspector.build.js?v=18.15.1"></script>
<script defer src="ui/inspector/inspector.paths.js?v=18.15.0"></script>
<script defer src="ui/inspector/inspector.resources.js?v=18.15.1"></script>
<script defer src="ui/inspector/inspector.tests.js?v=18.15.0"></script>

<!-- Overlay-Bindings (falls genutzt) -->
<script defer src="ui/inspector/overlay.hooks.js?v=1.4"></script>

<!-- Tools IM Inspector -->
<script defer src="ui/inspector/events.scan.js"></script>

<!-- Optional: nur Anzeige, wenn du willst -->
<!--script defer src="ui/inspector/inspector.tab.events.js"></script-->

  <!-- Fallback: sorgt dafür, dass der Button da ist & funktioniert -->
  <!--script defer src="ui/inspector/inspector.ensure-button.js"></script>
  <script defer src="ui/inspector/inspector.ensure-host.js"></script>
  <script defer src="ui/inspector/inspector.fix-runtime.js"></script-->
  <!-- script>
    // Optionales Auto-Open: aus (Start-BG sichtbar halten)
    // window.InspectorConfig = { autoOpen: true };
</script -->

  <!-- 4) Loader, die READY-Events feuern (müssen dispatchen):
         'cb:assets-ready'  (core/asset.js)
         'cb:registry:ready' (core/registry.js)
         Siehe Registry-Patch im Lastenheft. -->
  <script src="core/asset.js?v=25.10.19-final2"></script>
  <script src="core/registry.js?v=25.10.19-final2"></script>

  <!-- 5) UI: Startscreen/Panel (erzeugt Startpanel + BG, emittiert 'cb:ui-ready') -->
  <script src="ui/ui-start.js?v=25.10.19-final2"></script>

  <!-- 6) UI: HUD & BuildDock (bestehende Module; hören auf Events)
         - HUD zeigt Ressourcen nach Spielstart (cb:game-start / cb:res:change)
         - BuildDock nutzt #btn-build & #build-dock -->
  <script src="ui/ui-hud.js?v=25.10.19-final2"></script>
  <script src="ui/ui-build.js?v=25.10.19-final2"></script>

  <!-- 7) Debug Overlay für Pfade/Heatmap (vom Inspector gesteuert) -->
  <script src="core/path-overlay.js?v=25.10.19-final2"></script>

  <!-- 8) Boot + Spiel -->
  <script src="core/boot.js?v=25.10.19-final2"></script>
  <script src="core/game.bootstrap.js?v=25.10.19-final2"></script>
  <script src="core/game.js?v=25.10.19-final2"></script>

  <!-- 9) Layout-Glue ganz zum Schluss: schaltet NACH Spielstart auf Spiel-Layout -->
  <script src="ui/ui-layout.js?v=25.10.19-final2"></script>

  <!-- 10) Mini-Diagnose (öffnet NICHT den Inspector) -->
  <script>
    (window.CBLog?.info||console.info)('[index] geladen v25.10.19-final2');

    // Harte Absicherung: niemals "offen" starten, selbst wenn eine Altlast die Klasse gesetzt hat.
    (function(){
      var host = document.getElementById('inspector-overlay');
      if (host) { host.classList.remove('open'); host.style.display='none'; }
      // Layout initial NICHT aktiv → Start-BG sichtbar
      document.body.classList.remove('is-playing');
    }());
  </script>
</body>
</html>
